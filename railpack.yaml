version: "1.0"
region: europe-west4

services:
  web:
    type: web
    env:
      - name: PORT
        value: "8000"
    start: uvicorn app.api.main:app --host 0.0.0.0 --port=$PORT
    healthcheck:
      path: /health
      interval: 30s
      timeout: 5s

  worker:
    type: worker
    start: python -m app.bot.main

build:
  runtime: python
  install: pip install -r requirements.txt
  cache: true

env:
  ENV: "prod"
  LOG_LEVEL: "INFO"

resources:
  cpu: 1
  memory: 1Gi
